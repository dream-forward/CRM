<!DOCTYPE html>
<!--suppress ALL-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>全部商机</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/layui/layui.js"></script>
</head>
<body>
<div style="width:1600px;overflow-x: auto;overflow-y: hidden">
    <div id="left" style="width:25%;float:left;">
        <div class="layui-header" style="height: 15vh;margin: 0 auto;text-align: left;line-height: 80px;">
            <a class="logo">
                <img src="/images/index.jpg" style="width: 50px;height: 50px;">
            </a>
            <span style="color: #0C0C0C;font-size: 30px">全部商机</span>
        </div>
        <div class="layui-col-md8" style="border: 1px solid #ddd;width: 90%">
            <div class="layui-card">
                <div class="layui-card-header"><span style="float: left;"><b>分类</b></span></div>
                <div class="layui-card-body" style="width: 100%;">
                    <div style="border: 1px solid #ddd;width: 90%">
                    <ul>
                        <li><a href="javascript:;" id="type1"><font color="blue">进行中的商机</font></a><span id="jingxingzhong" class="layui-badge layui-bg-blue"
                                                           style="width:20px;float: right;margin-top: 2px;margin-right: 20px">18</span>
                        <li><a href="javascript:;" id="day7"><font color="blue">7天未跟单</font></a><span id="qi" class="layui-badge layui-bg-blue"
                                                                                     style="width:20px;float: right;margin-top: 2px;margin-right: 20px">18</span>
                        </li>
                        <li><a href="javascript:;" id="day30"><font color="blue">30天未跟单</font></a><span id="sanshi" class="layui-badge layui-bg-blue"
                                                                                     style="width:20px;float: right;margin-top: 2px;margin-right: 20px">4</span>
                        </li>
                        <li><a href="javascript:;" id="day90"><font color="blue">90天未跟单</font></a><span id="jiushi" class="layui-badge layui-bg-blue"
                                                                                     style="width:20px;float: right;margin-top: 2px;margin-right: 20px">9</span>
                        </li>
                    </ul>
                    </div>
                </div>
                <div class="layui-card-body" style="width: 100%;">
                    <div style="border: 1px solid #ddd;width: 90%">
                    <ul>
                        <li><a href="javascript:;" id="time1"><font color="blue">本周新增</font></a><span id="benzhou" class="layui-badge layui-bg-blue"
                                                         style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                        <li><a href="javascript:;" id="time2"><font color="blue">上周新增</font></a><span id="shangzhou" class="layui-badge layui-bg-blue"
                                                         style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                        <li><a href="javascript:;" id="time3"><font color="blue">本月新增</font></a><span id="benyue" class="layui-badge layui-bg-blue"
                                                         style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                        <li><a href="javascript:;" id="time4"><font color="blue">上月新增</font></a><span id="shangyue" class="layui-badge layui-bg-blue"
                                                         style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                        <li><a href="javascript:;" id="time5"><font color="blue">本季度新增</font></a><span id="benjidu" class="layui-badge layui-bg-blue"
                                                          style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                        <li><a href="javascript:;" id="time6"><font color="blue">上季度新增</font></a><span id="shangjidu" class="layui-badge layui-bg-blue"
                                                          style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                        </li>
                    </ul>
                    </div>
                </div>
                <div class="layui-card-body" style="width: 100%;">
                    <div style="border: 1px solid #ddd;width: 90%">
                        <ul>
                            <li><a href="javascript:;" id="busiphase1"><font color="blue">已成交的商机</font></a><span id="chengjiao" class="layui-badge layui-bg-blue"
                                                                                       style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                            </li>
                            <li><a href="javascript:;" id="busiphase2"><font color="blue">已丢单的商机</font></a><span id="diudan" class="layui-badge layui-bg-blue"
                                                                                       style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                            </li>
                            <li><a href="javascript:;" id="busiphase3"><font color="blue">已搁置的商机</font></a><span id="gezhi" class="layui-badge layui-bg-blue"
                                                                                       style="width:20px;float: right;margin-top: 2px;margin-right: 20px">0</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div id="right" style="float:right;  width:75%;  height:100%;">

        <div style="border: 1px solid #dddddd;">
        <form class="layui-form layui-form-pane" id="for" style="margin-top: 20px;margin-left: 50px;"  method="post">
            <div class="layui-inline">
                <div class="layui-form-item">
                    <label class="layui-form-label">商机全称</label>
                    <div class="layui-input-inline" style="width:200px;">
                        <input name="busname"  class="layui-input" type="text" style="width:200px;"  autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="layui-inline">
            <div class="layui-form-item">
                <label class="layui-form-label">商机阶段</label>
                <div class="layui-input-inline" style="width:200px;">
                    <input name="busiphase"  class="layui-input" type="text" style="width:200px;"  autocomplete="off">
                </div>
            </div>
        </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <label class="layui-form-label">商机负责人</label>
                    <div class="layui-input-inline" style="width:200px;">
                        <input name="busprincipal"  class="layui-input" type="text" style="width:200px;"  autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <label class="layui-form-label">所属部门</label>
                    <div class="layui-input-inline" style="width:200px;">
                        <input name="busdept"  class="layui-input" type="text" style="width:200px;"  autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <label class="layui-form-label">成交金额</label>
                    <div class="layui-input-inline" style="width:200px;">
                        <input name="maymoney"  class="layui-input" type="text" style="width:200px;"  autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <label class="layui-form-label">结单日期</label>
                    <div class="layui-input-inline" style="width:200px;">
                        <input name="maydate" id="date" class="layui-input" type="text" style="width:200px;" placeholder="yyyy-MM-dd" autocomplete="off">
                    </div>
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <div class="layui-input-block" style="width: 200px;">
                        <button class="layui-btn layui-btn-normal layui-btn-radius" style="width: 200px;"  lay-submit lay-filter="sub">查找商机</button>
                    </div>
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-form-item">
                    <div class="layui-input-block" style="width: 200px;">
                        <a href="javascript:;" id="res" style="width: 200px;"  class="layui-btn layui-btn-primary layui-btn-radius" >重置</font></a>
                    </div>
                </div>
            </div>

        </form>
        </div>

        <div class="layui-inline" style="margin-left:1000px;">
            <a href="javascript:;" id="add" style="color: black" class="layui-btn layui-icon layui-icon-add-1" ><font color="black">新增商机</font></a>
            <a href="javascript:;" id="flush" style="color: black"  class="layui-btn layui-icon layui-icon-refresh"><font color="black">刷新</font></a>
        </div>

        <table lay-even lay-skin="line" lay-size="lg" id="demo" lay-filter="test" class="layui-table"></table>
        <script type="text/html" id="toupdat">
            <a href="/business/toUpdateBusinessById.do?id={{d.busid}}" style="color: #1991FA" target="_blank">{{d.busname}}</a>
        </script>
    </div>
</div>

<script>
    layui.use(['laydate','form','table','jquery'], function () {
    var laydate=layui.laydate,
        table=layui.table,
        form=layui.form,
        $=layui.jquery;
        //新增商机
        $("#add").click(function(){
            window.open("alladdbusiness.html");
        });
        //日期
        laydate.render({
            elem: '#date'
        });
        //重置
        $("#res").click(function(){
            document.getElementById("for").reset();
        });
        //刷新
        $("#flush").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //进行中的商机
        $("#type1").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    doing:"doing"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //7天未跟单
        $("#day7").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    day:"day7"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //三十天未跟单
        $("#day30").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    day:"day30"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //九十天未跟单
        $("#day90").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    day:"day90"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //本周新增
        $("#time1").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time1"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //上周新增
        $("#time2").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time2"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //本月新增
        $("#time3").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time3"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //上月新增
        $("#time4").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time4"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //本季度新增
        $("#time5").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time5"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //上季度新增
        $("#time6").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    time:"time6"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });

        //已成交
        $("#busiphase1").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    jieduan:"成交"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //已丢单
        $("#busiphase2").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    jieduan:"丢单"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });
        //已搁置
        $("#busiphase3").click(function(){
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    jieduan:"搁置"
                } //设定异步数据接口的额外参数
                //,height: 300
            });
        });



        //form表单条件查询
        form.on('submit(sub)', function (data) {
            table.reload('demo', {
                url: '/business/queryBusiness.do'
                , where: {
                    limit:10,
                    busname: data.field.busname,
                    busiphase: data.field.busiphase,
                    busdept: data.field.busdept,
                    busprincipal: data.field.busprincipal,
                    maymoney: data.field.maymoney,
                    maydate: data.field.maydate,
                } //设定异步数据接口的额外参数
                //,height: 300
            });
            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });
        //表格重载
        table.render({
            limit: 10
            , limits: [2, 4, 6, 8, 10]
            , elem: '#demo'
            , url:'/business/queryBusiness.do' //数据接口
            , page: true //开启分页
            , cols: [[ //表头
                  {field: 'busname', title: '商机名称',toolbar:'#toupdat'}
                , {field: 'busiphase', title: '商机阶段'}
                , {field: 'maymoney', title: '预计成交金额',}
                , {field: 'busprincipal', title: '商机负责人',}
                , {field: 'lastdate', title: '最后跟单',}
                , {field: '1', title: '讨论版'}

            ]]
        });


    });

    //异步查询左边菜单栏数量
    $(function () {
        $.get("/business/allqueryCount.do",function(date){
            $("#jingxingzhong").text(date.jingxingzhong);
            $("#qi").text(date.qi);
            $("#sanshi").text(date.sanshi);
            $("#jiushi").text(date.jiushi);
            $("#benzhou").text(date.benzhou);
            $("#shangzhou").text(date.shangzhou);
            $("#benyue").text(date.benyue);
            $("#shangyue").text(date.shangyue);
            $("#benjidu").text(date.benjidu);
            $("#shangjidu").text(date.shangjidu);
            $("#chengjiao").text(date.chengjiao);
            $("#diudan").text(date.diudan);
            $("#gezhi").text(date.gezhi);
        });
    });


</script>
</body>
</html>