<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>å”®åæœåŠ¡</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
</head>
<script src="/js/jquery-1.12.3.min.js"></script>
<script src="/layui/layui.js" charset="utf-8"></script>
<body>
<div style="width:1366px;overflow-x:auto;overflow-y:hidden">
    <!--å¤´éƒ¨-->

    <!--å·¦ä¾§-->
    <div id="left" style="width:20%;float:left;">
        <div class="layui-header" style="height: 15vh;margin: 0 auto;text-align: left;line-height: 80px;">
            <a class="logo">
                <img src="/images/index.jpg" style="width: 50px;height: 50px;">
            </a>
            <span style="color: #0C0C0C;font-size: 30px">å”®åæœåŠ¡</span>
        </div>
        <div class="layui-col-md8" style="border: 1px solid #ddd;width: 90%;border-radius: 10px">
            <div class="layui-card">
                <div class="layui-card-header"><span style="float: left;"><b>åˆ†ç±»</b></span></div>
                <div class="layui-card-body" style="width: 100%;">
                    <ul>
                        <li><a id="processing" style="color: #01AAED">å¤„ç†ä¸­çš„æœåŠ¡</a><span id="-processing"
                                                                                      class="layui-badge layui-bg-blue"
                                                                                      style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="finished" style="color: #01AAED">å·²ç»“æŸçš„æœåŠ¡</a><span id="-finished"
                                                                                    class="layui-badge layui-bg-blue"
                                                                                    style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="revocation" style="color: #01AAED">å·²æ’¤é”€çš„æœåŠ¡</a><span id="-revocation"
                                                                                      class="layui-badge layui-bg-blue"
                                                                                      style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                    </ul>
                </div>
                <hr>
                <div class="layui-card-body" style="width: 100%;">
                    <ul>
                        <li><a id="This-week-the-new" style="color: #01AAED">æœ¬å‘¨æ–°å¢</a><span
                                id="-This-week-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-week-the-new" style="color: #01AAED">ä¸Šå‘¨æ–°å¢</a><span
                                id="-Last-week-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="This-month-the-new" style="color: #01AAED">æœ¬æœˆæ–°å¢</a><span
                                id="-This-month-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-month-the-new" style="color: #01AAED">ä¸Šæœˆæ–°å¢</a><span
                                id="-Last-month-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="This-quarter-the-new" style="color: #01AAED">æœ¬å­£åº¦æ–°å¢</a><span
                                id="-This-quarter-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-quarter-the-new" style="color: #01AAED">ä¸Šå­£åº¦æ–°å¢</a><span
                                id="-Last-quarter-the-new"
                                class="layui-badge layui-bg-blue"
                                style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
    <!--å³ä¾§-->
    <div style="margin-right:10px;float:right;width:78%;">
        <div class="layui-header" style="height: 15vh;margin: 0 auto;text-align: left;line-height: 80px;">
            <form class="layui-form">
                <!--ä¸‹æ‹‰æ¡†-->
                <div class="layui-inline" style="height: 40px;width: 180px;">
                    <select name="name">
                        <option value=''>è¯·é€‰æ‹©</option>
                        <option value="assubject">æŒ‰ä¸»é¢˜</option>
                        <option value="servicetype">æŒ‰æœåŠ¡ç±»å‹</option>
                        <option value="beginservicedate">æŒ‰å¼€å§‹æ—¶é—´</option>
                        <option value="serviceperson">æŒ‰æœåŠ¡äººå‘˜</option>
                        <option value="servicecore">æŒ‰æœåŠ¡è¯„åˆ†</option>
                    </select>
                </div>
                <!--æ–‡æœ¬æ¡†-->
                <div class="layui-inline" style="height: 40px;width: 300px;">
                    <input type="text" name="value" height="0" size="80px;"
                           placeholder="è¯·è¾“å…¥å…³é”®å­—æ¨¡ç³ŠæŸ¥è¯¢" autocomplete="off" class="layui-input">
                </div>
                <div class="layui-inline">
                    <button class="layui-btn" lay-submit lay-filter="search" style="width: 90px;height: 40px;">ğŸ”æŸ¥æ‰¾
                    </button>
                    <button type="reset" class="layui-btn layui-btn-primary" style="height: 40px;">é‡ç½®</button>
                </div>
                <div class="layui-inline" style="left: 80px;">
                    <a href="javascript:window.open('/view/addaftersales.html');" id="add" style="color: black"
                       class="layui-btn layui-icon layui-icon-add-1">æ–°å¢å”®åæœåŠ¡</a>
                    <a href="javascript:location.reload()" style="color: black"
                       class="layui-btn layui-icon layui-icon-refresh">åˆ·æ–°</a>
                </div>
            </form>
        </div>


        <!--<table lay-even lay-skin="line" lay-size="lg" id="demo" lay-filter="test" class="layui-table"></table>-->
        <table id="demo" lay-filter="test" style="width: 100%"></table>
    </div>
</div>
<script type="text/html" id="subject">
    <a href="/aftersales/queryAfterSalesDetail.do?asid={{d.asid}}" style="color: #01AAED" target="_blank">{{d.assubject}}</a>
</script>
<script>
    layui.use(['form', 'table'], function () {
        var form = layui.form;
        var table = layui.table;

        //ç¬¬ä¸€ä¸ªè¡¨æ ¼
        var tableIns = table.render({
            elem: '#demo'
            , height: 'auto'
            , title: 'å”®åæœåŠ¡ä¸€è§ˆ'
            , autoSort: true
            , url: '/aftersales/queryAftersales.do' //æ•°æ®æ¥å£
            , page: true //å¼€å¯åˆ†é¡µ
            , limit: 10
            , limits: [1, 3, 5, 7, 10, 20, 30]
            , cols: [
                [ //è¡¨å¤´
                    {field: 'assubject', title: 'ä¸»é¢˜', align: 'center', width: 1366 * 0.38, toolbar: '#subject'}
                    , {field: 'servicetype', title: 'æœåŠ¡ç±»å‹', align: 'center', width: 1366 * 0.1}
                    , {
                    field: 'beginservicedate',
                    title: 'å¼€å§‹æ—¶é—´',
                    align: 'center',
                    width: 1366 * 0.1,
                    templet: "<div>{{layui.util.toDateString(d.starttime, 'yyyy-MM-dd')}}</div>"
                }
                    , {field: 'serviceperson', title: 'æœåŠ¡äººå‘˜', align: 'center', width: 1366 * 0.1}
                    , {field: 'servicecore', title: 'æœåŠ¡è¯„åˆ†', align: 'center'}
                ]
            ]/*,done: function (res, curr, count) {// è¡¨æ ¼æ¸²æŸ“å®Œæˆä¹‹åçš„å›è°ƒ
                var that = this.elem.next();
                res.data.forEach(function (item, index) {
                    //console.log(item.empName);itemè¡¨ç¤ºæ¯åˆ—æ˜¾ç¤ºçš„æ•°æ®
                    if (index % 2 == 0) {
                        var tr = that.find(".layui-table-box tbody tr[data-index='" + index + "']").css("background-color", "#6666FF");
                    } else {
                        var tr = that.find(".layui-table-box tbody tr[data-index='" + index + "']").css("background-color", "#CCCCFF");
                    }
                });
            }*/
                });

        //è¡¨æ ¼é‡è½½
        form.on('submit(search)', function (data) {
            var kv = data.field //å½“å‰å®¹å™¨çš„å…¨éƒ¨è¡¨å•å­—æ®µï¼Œåå€¼å¯¹å½¢å¼ï¼š{name: value}
            console.log(data.field)
            //æ‰§è¡Œé‡è½½ æ¨¡ç³ŠæŸ¥è¯¢
            tableIns.reload({
                url: '/aftersales/queryAftersales.do'
                , where: kv
            });
            return false; //é˜»æ­¢è¡¨å•è·³è½¬ã€‚å¦‚æœéœ€è¦è¡¨å•è·³è½¬ï¼Œå»æ‰è¿™æ®µå³å¯ã€‚
        });

        //-----------------------------------------------------------------------------
        //å…³äºåˆ†ç±»æŸ¥è¯¢--å¤„ç†ä¸­
        $("#processing").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersales.do'
                , where: {
                    name: "aftersalesstatus",
                    value: "å¤„ç†ä¸­"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--å·²å®Œæˆ
        $("#finished").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersales.do'
                , where: {
                    name: "aftersalesstatus",
                    value: "å·²ç»“æŸ/å·²å®Œæˆ/å·²æˆäº¤"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--å·²æ’¤é”€
        $("#revocation").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersales.do'
                , where: {
                    name: "aftersalesstatus",
                    value: "å·²æ’¤é”€/æ’¤é™¤"
                }
            });
        });

        //-----------------------------------------------------------------------------
        //å…³äºåˆ†ç±»æŸ¥è¯¢--æœ¬å‘¨æ–°å¢ This-week-the-new
        $("#This-week-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "This-week-the-new"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--ä¸Šå‘¨æ–°å¢ Last-week-the-new
        $("#Last-week-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "Last-week-the-new"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--æœ¬æœˆæ–°å¢ This-month-the-new
        $("#This-month-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "This-month-the-new"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--ä¸Šæœˆæ–°å¢ Last-month-the-new
        $("#Last-month-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "Last-month-the-new"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--æœ¬å­£åº¦æ–°å¢ This-quarter-the-new
        $("#This-quarter-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "This-quarter-the-new"
                }
            });
        });
        //å…³äºåˆ†ç±»æŸ¥è¯¢--ä¸Šå­£åº¦å‘¨æ–°å¢ Last-quarter-the-new
        $("#Last-quarter-the-new").click(function () {
            tableIns.reload({
                url: '/aftersales/queryAftersalesByTime.do'
                , where: {
                    flag: "Last-quarter-the-new"
                }
            });
        });

        //---------------------------------æ–‡æ¡£å°±ç»ªæŸ¥æ•°é‡--------------------------------------
        $(function () {
            //å¤„ç†ä¸­çš„æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersales.do?name=aftersalesstatus&value=å¤„ç†ä¸­&page=1&limit=1",
                success: function (num) {
                    $("#-processing").text(num.count);
                }
            });
            //å·²å®Œæˆçš„æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersales.do?name=aftersalesstatus&value=å·²ç»“æŸ/å·²å®Œæˆ/å·²æˆäº¤&page=1&limit=1",
                success: function (num) {
                    $("#-finished").text(num.count);
                }
            });
            //å·²æ’¤é”€çš„æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersales.do?name=aftersalesstatus&value=å·²æ’¤é”€/æ’¤é™¤&page=1&limit=1",
                success: function (num) {
                    $("#-revocation").text(num.count);
                }
            });
            //ç»Ÿè®¡æœ¬å‘¨æ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-This-week-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-week-the-new").text(num.count);
                }
            });
            //ç»Ÿè®¡ä¸Šå‘¨æ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-Last-week-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-week-the-new").text(num.count);
                }
            });
            //ç»Ÿè®¡æœ¬æœˆæ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-This-month-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-month-the-new").text(num.count);
                }
            });
            //ç»Ÿè®¡ä¸Šæœˆæ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-Last-month-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-month-the-new").text(num.count);
                }
            });
            //ç»Ÿè®¡æœ¬å­£åº¦æ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-This-quarter-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-quarter-the-new").text(num.count);
                }
            });
            //ç»Ÿè®¡ä¸Šå­£åº¦æ–°å¢æ•°é‡
            $.ajax({
                url: "/aftersales/queryAftersalesByTime.do?flag=-Last-quarter-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-quarter-the-new").text(num.count);
                }
            });


        });
    });
</script>
</body>
</html>