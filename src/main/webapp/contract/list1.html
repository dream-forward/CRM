<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>合同管理</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
</head>
<script src="/js/jquery-1.12.3.min.js"></script>
<script src="/layui/layui.js" charset="utf-8"></script>
<body>
<div style="width:1400px;overflow-x:auto;overflow-y:hidden">
    <!--头部-->

    <!--左侧-->
    <div id="left" style="width:20%;float:left;">
        <div class="layui-header" style="height: 15vh;margin: 0 auto;text-align: left;line-height: 80px;">
           &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a class="logo">
                <img src="/images/index.jpg" style="width: 50px;height: 50px;">
            </a>
            <span style="color: #0C0C0C;font-size: 30px">全部合同</span>
        </div>
        <div class="layui-col-md8" style="border: 1px solid #ddd;width: 90%;border-radius: 10px">
            <div class="layui-card">
                <div class="layui-card-header"><span style="float: left;"><b>分类</b></span></div>
                <div class="layui-card-body" style="width: 100%;">
                    <ul>
                        <li><a id="executing" style="color: #01AAED">执行中的合同</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-executing"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="closed" style="color: #01AAED">已关闭的合同</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-closed"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="removed" style="color: #01AAED">已撤除的合同</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-removed"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="shelved" style="color: #01AAED">已搁置的合同</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-shelved"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                    </ul>
                </div>
                <hr>
                <div class="layui-card-body" style="width: 100%;">
                    <ul>
                        <li><a id="This-week-the-new" style="color: #01AAED">本周新增</a>
                            <span class="layui-badge layui-bg-blue"
                             id="-This-week-the-new"
                             style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-week-the-new" style="color: #01AAED">上周新增
                        </a><span class="layui-badge layui-bg-blue"
                        id="-Last-week-the-new"
                        style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="This-month-the-new" style="color: #01AAED">本月新增</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-This-month-the-new"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-month-the-new" style="color: #01AAED">上月新增</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-Last-month-the-new"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="This-quarter-the-new" style="color: #01AAED">本季度新增</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-This-quarter-the-new"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                        <li><a id="Last-quarter-the-new" style="color: #01AAED">上季度新增</a>
                            <span class="layui-badge layui-bg-blue"
                            id="-Last-quarter-the-new"
                            style="width:20px;float: right;margin-top: 2px;margin-right: 20px"></span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
    <!--右侧-->
    <div style="margin-right:10px;float:right;width:78%;">
        <div class="layui-header" style="height: 15vh;margin: 0 auto;text-align: left;line-height: 80px;">
            <form class="layui-form">
                <!--下拉框-->
                &nbsp;&nbsp;&nbsp;&nbsp;        <div class="layui-inline" style="height: 40px;width: 180px;">
                    <select id="selectss" name="selectss">
                        <option value="">请选择</option>
                        <option value="1">按合同名称</option>
                        <option value="2">按合同编号</option>
                        <option value="3">按合同所属部门</option>
                        <option value="4">按关联人员</option>
                        <option value="5">按合同金额</option>
                        <option value="6">按签约日期</option>
                    </select>
                </div>
                <!--文本框-->
                <div class="layui-inline" style="height: 40px;width: 300px;">
                    <input type="text" name="inputss" height="0" size="80px;" required lay-verify="required"
                           placeholder="请输入关键字查询" autocomplete="off" class="layui-input">
                </div>
                <div class="layui-inline">
                    <button class="layui-btn" lay-submit  lay-filter="demo1" style="width: 90px;height: 40px;">🔍查找
                    </button>
                    <button type="reset" class="layui-btn layui-btn-primary" style="height: 40px;">重置</button>
                </div>
                <div class="layui-inline" style="left: 80px;">
                    <a href="javascript:;" onclick="aaa()" style="color: black" class="layui-btn layui-icon layui-icon-add-1">新增合同</a>
                    <a href="http://www.layui.com" style="color: black" class="layui-btn layui-icon layui-icon-refresh">刷新</a>
                </div>
            </form>
        </div>


        <table id="demo" lay-filter="test" style="width: 100%"></table>
    </div>
</div>

<script type="text/html" id="conname">
    <a class="layui-table-link" target="blank" onclick=window.location.href="/contract/ToUpdate.do?conid={{d.conid}}">{{d.conname}}</a>
</script>

<script type="text/html" id="incmoney">
    <a class="layui-table-link" target="blank" onclick=window.location.href="/contract/ToUpdates.do?conid={{d.conid}}">{{d.incmoney}}</a>
</script>

<script>

    var aaa=function(){
        window.open("/contract/add.html");
    }

    layui.use(['form', 'table'], function () {
        var form = layui.form;
        var table = layui.table;

        //第一个表格
        var tableIns = table.render({
            elem: '#demo'
            , height: 'auto'
            , autoSort: true
            , url: '/contract/QueryContractBo.do?selectss=0' //数据接口
            , page: true //开启分页
            , limit: 10
            , limits: [1, 3, 5, 7, 10, 20, 30]
            , cols: [
                [ //表头
                    , {field: 'conname', title: '合同名称',width:1400*0.23,align: 'center',toolbar:'#conname'}
                    , {field: 'connum', title: '合同编号',width:1400*0.11, align: 'center'}
                    , {field: 'conmoney', title: '合同金额',width:1400*0.1, align: 'center'}
                    , {field: 'incmoney', title: '汇款额',width:1400*0.1, align: 'center',toolbar:'#incmoney'}
                    , {field: 'billmoney', title: '开票额',width:1400*0.1, align: 'center'}
                    , {field: 'condate', title: '签约日期',width:1400*0.13, align: 'center',templet: "<div>{{layui.util.toDateString(d.starttime, 'yyyy-MM-dd')}}</div>"}
                ]
            ]
        });

        //-----------------------------------------------------------------------------
        //关于分类查询--执行中
        $("#executing").click(function () {
            tableIns.reload({
                url: '/contract/queryContract.do'
                , where: {
                    name: "currentstatus",
                    value: "1"
                }
            });
        });
        //关于分类查询--已关闭
        $("#closed").click(function () {
            tableIns.reload({
                url: '/contract/queryContract.do'
                , where: {
                    name: "currentstatus",
                    value: "2"
                }
            });
        });
        //关于分类查询--已撤除
        $("#removed").click(function () {
            tableIns.reload({
                url: '/contract/queryContract.do'
                , where: {
                    name: "currentstatus",
                    value: "3"
                }
            });
        });

        //关于分类查询--已搁置
        $("#shelved").click(function () {
            tableIns.reload({
                url: '/contract/queryContract.do'
                , where: {
                    name: "currentstatus",
                    value: "4"
                }
            });
        });

        //-----------------------------------------------------------------------------
        //关于分类查询--本周新增 This-week-the-new
        $("#This-week-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "This-week-the-new"
                }
            });
        });
        //关于分类查询--上周新增 Last-week-the-new
        $("#Last-week-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "Last-week-the-new"
                }
            });
        });
        //关于分类查询--本月新增 This-month-the-new
        $("#This-month-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "This-month-the-new"
                }
            });
        });
        //关于分类查询--上月新增 Last-month-the-new
        $("#Last-month-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "Last-month-the-new"
                }
            });
        });
        //关于分类查询--本季度新增 This-quarter-the-new
        $("#This-quarter-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "This-quarter-the-new"
                }
            });
        });
        //关于分类查询--上季度周新增 Last-quarter-the-new
        $("#Last-quarter-the-new").click(function () {
            tableIns.reload({
                url: '/contract/QueryContractByTime.do'
                , where: {
                    flag: "Last-quarter-the-new"
                }
            });
        });

        //---------------------------------文档就绪查数量--------------------------------------
        $(function () {
            //执行中的数量
            $.ajax({
                url: "/contract/queryContract.do?name=currentstatus&value=1&page=1&limit=1",
                success: function (num) {
                    $("#-executing").text(num.count);
                }
            });
            //已关闭的数量
            $.ajax({
                url: "/contract/queryContract.do?name=currentstatus&value=2&page=1&limit=1",
                success: function (num) {
                    $("#-closed").text(num.count);
                }
            });
            //已撤除的数量
            $.ajax({
                url: "/contract/queryContract.do?name=currentstatus&value=3&page=1&limit=1",
                success: function (num) {
                    $("#-removed").text(num.count);
                }
            });
            //已搁置的数量
            $.ajax({
                url: "/contract/queryContract.do?name=currentstatus&value=4&page=1&limit=1",
                success: function (num) {
                    $("#-shelved").text(num.count);
                }
            });

            //统计本周新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-This-week-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-week-the-new").text(num.count);
                }
            });
            //统计上周新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-Last-week-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-week-the-new").text(num.count);
                }
            });
            //统计本月新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-This-month-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-month-the-new").text(num.count);
                }
            });
            //统计上月新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-Last-month-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-month-the-new").text(num.count);
                }
            });
            //统计本季度新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-This-quarter-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-This-quarter-the-new").text(num.count);
                }
            });
            //统计上季度新增数量
            $.ajax({
                url: "/contract/QueryContractByTime.do?flag=-Last-quarter-the-new&page=1&limit=1",
                success: function (num) {
                    $("#-Last-quarter-the-new").text(num.count);
                }
            });


        });
        //搜索按钮
        form.on('submit(demo1)', function(data){
            table.reload('demo',{
                url: '/contract/QueryContractBo.do',
                where:data.field,
                method:'post',
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
            return false;
        });
    });
</script>
</body>
</html>